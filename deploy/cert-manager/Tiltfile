k8s_yaml(helm('.', name='cert-manager', namespace='cert-manager', values=['./values.tilt.yaml']))

k8s_resource(
    workload='cert-manager',
    objects=[
        'cert-manager:namespace',
        'certificaterequests.cert-manager.io:customresourcedefinition',
        'certificates.cert-manager.io:customresourcedefinition',
        'challenges.acme.cert-manager.io:customresourcedefinition',
        'clusterissuers.cert-manager.io:customresourcedefinition',
        'issuers.cert-manager.io:customresourcedefinition',
        'orders.acme.cert-manager.io:customresourcedefinition',
        'cert-manager:serviceaccount',
        'cert-manager\\:leaderelection:role',
        'cert-manager-controller-issuers:clusterrole',
        'cert-manager-controller-clusterissuers:clusterrole',
        'cert-manager-controller-certificates:clusterrole',
        'cert-manager-controller-orders:clusterrole',
        'cert-manager-controller-challenges:clusterrole',
        'cert-manager-controller-ingress-shim:clusterrole',
        'cert-manager-view:clusterrole',
        'cert-manager-edit:clusterrole',
        'cert-manager-controller-approve\\:cert-manager-io:clusterrole',
        'cert-manager-controller-certificatesigningrequests:clusterrole',
        'cert-manager\\:leaderelection:rolebinding',
        'cert-manager-controller-issuers:clusterrolebinding',
        'cert-manager-controller-clusterissuers:clusterrolebinding',
        'cert-manager-controller-certificates:clusterrolebinding',
        'cert-manager-controller-orders:clusterrolebinding',
        'cert-manager-controller-challenges:clusterrolebinding',
        'cert-manager-controller-ingress-shim:clusterrolebinding',
        'cert-manager-controller-approve\\:cert-manager-io:clusterrolebinding',
        'cert-manager-controller-certificatesigningrequests:clusterrolebinding'
    ],
    labels=['cert-manager']
)

k8s_resource(
    workload='cert-manager-cainjector',
    resource_deps=['cert-manager'],
    objects=[
        'cert-manager-cainjector:serviceaccount',
        'cert-manager-cainjector\\:leaderelection:role',
        'cert-manager-cainjector:clusterrole',
        'cert-manager-cainjector\\:leaderelection:rolebinding',
        'cert-manager-cainjector:clusterrolebinding'
    ],
    labels=['cert-manager']
)

k8s_resource(
    workload='cert-manager-webhook',
    resource_deps=['cert-manager'],
    objects=[
        'cert-manager-webhook:mutatingwebhookconfiguration',
        'cert-manager-webhook:serviceaccount',
        'cert-manager-webhook\\:dynamic-serving:role',
        'cert-manager-webhook\\:subjectaccessreviews:clusterrole',
        'cert-manager-webhook\\:dynamic-serving:rolebinding',
        'cert-manager-webhook\\:subjectaccessreviews:clusterrolebinding',
        'cert-manager-webhook:validatingwebhookconfiguration'
    ],
    labels=['cert-manager']
)
